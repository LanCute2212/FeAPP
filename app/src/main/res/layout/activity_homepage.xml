<?xml version="1.0" encoding="utf-8"?>
<androidx.core.widget.NestedScrollView xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:app="http://schemas.android.com/apk/res-auto"
  xmlns:tools="http://schemas.android.com/tools"
  android:id="@+id/scroll"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  android:background="#FFFFFF"
  android:fillViewport="true">

  <androidx.constraintlayout.widget.ConstraintLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:paddingTop="16dp"
    android:paddingBottom="100dp"
    android:paddingStart="16dp"
    android:paddingEnd="16dp">

    <!-- Toggle: Theo ngày / Theo tuần -->
    <Button
      android:id="@+id/btn_xem_chi_tiet"
      android:layout_width="0dp"
      android:layout_height="44dp"
      android:layout_marginTop="12dp"
      android:background="@drawable/btn_outline_green"
      android:backgroundTint="@null"
      android:text="Check details"
      android:textColor="#3B8F3B"
      app:layout_constraintEnd_toEndOf="parent"
      app:layout_constraintStart_toStartOf="parent"
      app:layout_constraintTop_toBottomOf="@id/meals_row" />

    <!-- Card: Calo & Dinh dưỡng -->
    <LinearLayout
      android:id="@+id/toggle_period"
      android:layout_width="0dp"
      android:layout_height="44dp"
      android:layout_marginTop="12dp"
      android:layout_marginBottom="12dp"
      android:padding="4dp"
      android:background="#F0F7F0"
      android:gravity="center"
      android:orientation="horizontal"
      app:layout_constraintEnd_toEndOf="parent"
      app:layout_constraintStart_toStartOf="parent"
      app:layout_constraintTop_toTopOf="parent">

      <TextView
        android:id="@+id/btn_theo_ngay"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:gravity="center"
        android:text="By Day"
        android:textColor="#9E9E9E"
        android:textSize="14sp" />

      <TextView
        android:id="@+id/btn_theo_tuan"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:gravity="center"
        android:text="By Week"
        android:textColor="#9E9E9E"
        android:textSize="14sp" />
    </LinearLayout>

    <!-- Section: Nhật ký ăn uống -->
    <LinearLayout
      android:id="@+id/meals_row"
      android:layout_width="0dp"
      android:layout_height="wrap_content"
      android:layout_marginTop="12dp"
      android:gravity="center"
      android:orientation="horizontal"
      app:layout_constraintEnd_toEndOf="parent"
      app:layout_constraintStart_toStartOf="parent"
      app:layout_constraintTop_toBottomOf="@id/title_nhatky">

      <LinearLayout
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:gravity="center"
        android:orientation="vertical">

        <FrameLayout
          android:layout_width="64dp"
          android:layout_height="64dp">

          <ImageView
            android:layout_width="50dp"
            android:layout_height="50dp"
            android:layout_gravity="center"
            android:contentDescription="sang"
            android:src="@drawable/ic_breakfast" />

          <ImageView
            android:id="@+id/breakfast_add_button"
            android:layout_width="15dp"
            android:layout_height="15dp"
            android:layout_margin="4dp"
            android:layout_gravity="bottom|end"
            android:src="@drawable/ic_add" />
        </FrameLayout>

        <TextView
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:layout_marginTop="8dp"
          android:text="Breakfast"
          android:textColor="#4A4A4A" />
      </LinearLayout>

      <LinearLayout
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:gravity="center"
        android:orientation="vertical">

        <FrameLayout
          android:layout_width="64dp"
          android:layout_height="64dp">

          <ImageView
            android:layout_width="50dp"
            android:layout_height="50dp"
            android:layout_gravity="center"
            android:contentDescription="trua"
            android:src="@drawable/ic_lunch" />

          <ImageView
            android:id="@+id/lunch_add_button"
            android:layout_width="15dp"
            android:layout_height="15dp"
            android:layout_margin="4dp"
            android:layout_gravity="bottom|end"
            android:src="@drawable/ic_add" />
        </FrameLayout>

        <TextView
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:layout_marginTop="8dp"
          android:text="Lunch"
          android:textColor="#4A4A4A" />
      </LinearLayout>

      <LinearLayout
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:gravity="center"
        android:orientation="vertical">

        <FrameLayout
          android:layout_width="64dp"
          android:layout_height="64dp">

          <ImageView
            android:layout_width="50dp"
            android:layout_height="50dp"
            android:layout_gravity="center"
            android:contentDescription="toi"
            android:src="@drawable/ic_dinner" />

          <ImageView
            android:id="@+id/dinner_add_button"
            android:layout_width="15dp"
            android:layout_height="15dp"
            android:layout_margin="4dp"
            android:layout_gravity="bottom|end"
            android:src="@drawable/ic_add" />
        </FrameLayout>

        <TextView
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:layout_marginTop="8dp"
          android:text="Dinner"
          android:textColor="#4A4A4A" />
      </LinearLayout>

    </LinearLayout>

    <!-- Row of meal circles: Sáng, Trưa, Tối, Phụ -->
    <LinearLayout
      android:id="@+id/quick_add_row"
      android:layout_width="0dp"
      android:layout_height="wrap_content"
      android:layout_marginTop="16dp"
      android:orientation="horizontal"
      app:layout_constraintEnd_toEndOf="parent"
      app:layout_constraintStart_toStartOf="parent"
      app:layout_constraintTop_toBottomOf="@id/collapse"></LinearLayout>

    <!-- Button: Xem chi tiết bữa ăn -->
    <TextView
      android:id="@+id/title_nhatky"
      android:textStyle="bold"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:layout_marginTop="12dp"
      android:fontFamily="@font/poppins_bold"
      android:text="Eating Schedule"
      android:textSize="18sp"
      app:layout_constraintStart_toStartOf="parent"
      app:layout_constraintTop_toBottomOf="@id/card_calories" />

    <!-- Chi tiết bữa ăn (removed) -->

    <!-- Footer small line "Thu gọn ^" -->
    <TextView
      android:id="@+id/collapse"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:layout_marginTop="8dp"
      android:textColor="#6B6B6B"
      android:textSize="13sp"
      app:layout_constraintEnd_toEndOf="parent"
      app:layout_constraintTop_toBottomOf="@id/btn_xem_chi_tiet" />

    <!-- Quick Add Icons Row -->

    <!-- Divider before Activity List -->
    <TextView
      android:id="@+id/list_activity"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:fontFamily="@font/poppins_bold"
      android:text="@string/list_activity"
      android:textSize="18sp"
      app:layout_constraintBottom_toBottomOf="@+id/quick_add_row"
      app:layout_constraintStart_toStartOf="parent"
      app:layout_constraintTop_toBottomOf="@+id/btn_xem_chi_tiet"
      app:layout_constraintVertical_bias="1.0" />

    <!-- Card: Activity List -->
    <androidx.cardview.widget.CardView
      android:id="@+id/card_calories"
      android:layout_width="0dp"
      android:layout_height="wrap_content"
      android:layout_marginTop="12dp"
      android:layout_marginHorizontal="4dp"
      android:paddingBottom="20dp"
      app:cardCornerRadius="20dp"
      app:cardElevation="6dp"
      app:cardBackgroundColor="#FFFFFF"
      app:layout_constraintEnd_toEndOf="parent"
      app:layout_constraintStart_toStartOf="parent"
      app:layout_constraintTop_toBottomOf="@id/toggle_period"
      app:layout_constraintBottom_toBottomOf="@id/nutrition_progress_section"
      app:layout_constraintVertical_bias="0.0">

      <androidx.constraintlayout.widget.ConstraintLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginHorizontal="8dp"
        android:paddingTop="20dp">
        
        <!-- Title -->
        <TextView
          android:id="@+id/title_cal"
          android:textStyle="bold"
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:fontFamily="@font/poppins_bold"
          android:text="Calories and Nutritions"
          android:textColor="#111111"
          android:textSize="18sp"
          app:layout_constraintStart_toStartOf="parent"
          app:layout_constraintTop_toTopOf="parent" />

        <FrameLayout
          android:id="@+id/apple_container"
          android:layout_width="150dp"
          android:layout_height="150dp"
          android:layout_marginStart="16dp"
          android:layout_marginTop="12dp"
          app:layout_constraintStart_toStartOf="parent"
          app:layout_constraintTop_toBottomOf="@id/title_cal">

          <ImageView
            android:id="@+id/apple_img_background"
            android:layout_width="150dp"
            android:layout_height="150dp"
            android:contentDescription="apple"
            android:src="@drawable/ic_danap"
            android:alpha="0.2" />

          <ImageView
            android:id="@+id/apple_img"
            android:layout_width="150dp"
            android:layout_height="150dp"
            android:contentDescription="apple"
            android:src="@drawable/ic_danap" />
        </FrameLayout>

        <LinearLayout
          android:id="@+id/right_stats"
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:layout_marginEnd="16dp"
          android:layout_marginTop="4dp"
          android:gravity="center_vertical"
          android:orientation="vertical"
          app:layout_constraintEnd_toEndOf="parent"
          app:layout_constraintTop_toBottomOf="@id/title_cal"
          app:layout_constraintBottom_toTopOf="@id/nutrition_divider">

          <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="8dp"
            android:gravity="center_vertical"
            android:orientation="horizontal">

            <ImageView
              android:id="@+id/lightning"
              android:layout_width="22dp"
              android:layout_height="22dp"
              android:contentDescription="energy"
              android:src="@drawable/ic_lightning" />

              <LinearLayout
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:layout_marginStart="10dp"
              android:orientation="vertical">

              <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Intake"
                android:textColor="#6B6B6B"
                android:textSize="11sp"
                android:letterSpacing="0.02" />

              <TextView
                android:id="@+id/tv_intake"
                android:textStyle="bold"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="553"
                android:textColor="#111111"
                android:textSize="20sp" />
            </LinearLayout>
          </LinearLayout>

          <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="10dp"
            android:gravity="center_vertical"
            android:orientation="horizontal">

            <ImageView
              android:layout_width="22dp"
              android:layout_height="22dp"
              android:contentDescription="remaining"
              android:src="@drawable/ic_plate" />

            <LinearLayout
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:layout_marginStart="10dp"
              android:orientation="vertical">

              <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Remaining"
                android:textColor="#6B6B6B"
                android:textSize="11sp"
                android:letterSpacing="0.02" />

              <TextView
                android:id="@+id/tv_remaining"
                android:textStyle="bold"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="553"
                android:textColor="#111111"
                android:textSize="20sp" />
            </LinearLayout>
          </LinearLayout>

          <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="center_vertical"
            android:orientation="horizontal">

            <ImageView
              android:id="@+id/fire"
              android:layout_width="22dp"
              android:layout_height="22dp"
              android:contentDescription="burn"
              android:src="@drawable/ic_fire" />

            <LinearLayout
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:layout_marginStart="10dp"
              android:orientation="vertical">

              <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Consumed"
                android:textColor="#6B6B6B"
                android:textSize="11sp"
                android:letterSpacing="0.02" />

              <TextView
                android:id="@+id/tv_consumed"
                android:textStyle="bold"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="0"
                android:textColor="#111111"
                android:textSize="20sp" />
            </LinearLayout>
          </LinearLayout>
        </LinearLayout>

        <!-- Divider -->
        <View
          android:id="@+id/nutrition_divider"
          android:layout_width="match_parent"
          android:layout_height="1dp"
          android:layout_marginHorizontal="24dp"
          android:layout_marginTop="20dp"
          android:layout_marginBottom="28dp"
          android:background="@android:color/darker_gray"
          android:alpha="0.3"
          app:layout_constraintTop_toBottomOf="@id/apple_container" />

        <!-- Nutrition Progress Bars Section (2x2 Grid) -->
        <LinearLayout
          android:id="@+id/nutrition_progress_section"
          android:layout_width="match_parent"
          android:layout_height="wrap_content"
          android:layout_marginTop="8dp"
          android:layout_marginBottom="16dp"
          android:layout_marginHorizontal="8dp"
          android:orientation="horizontal"
          android:paddingHorizontal="16dp"
          android:paddingTop="12dp"
          android:paddingBottom="8dp"
          android:background="#F8F9FA"
          android:layout_gravity="center"
          app:layout_constraintTop_toBottomOf="@id/nutrition_divider"
          app:layout_constraintBottom_toBottomOf="parent">

          <!-- Left Column -->
          <LinearLayout
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:layout_marginEnd="8dp"
            android:orientation="vertical">

            <!-- Carbs Progress -->
            <LinearLayout
              android:layout_width="match_parent"
              android:layout_height="wrap_content"
              android:layout_marginBottom="12dp"
              android:orientation="vertical">

            <LinearLayout
              android:layout_width="match_parent"
              android:layout_height="wrap_content"
              android:gravity="center_vertical"
              android:orientation="horizontal">

              <ImageView
                android:layout_width="20dp"
                android:layout_height="20dp"
                android:layout_marginEnd="8dp"
                android:contentDescription="carbs"
                android:src="@drawable/ic_carb" />

              <TextView
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:text="Carbs"
                android:textColor="#111111"
                android:textSize="14sp"
                android:textStyle="bold" />

              <TextView
                android:id="@+id/tv_carbs_progress"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="0/442g"
                android:textColor="#6B6B6B"
                android:textSize="12sp" />
            </LinearLayout>

            <ProgressBar
              android:id="@+id/progress_carbs"
              style="?android:attr/progressBarStyleHorizontal"
              android:layout_width="match_parent"
              android:layout_height="8dp"
              android:layout_marginTop="6dp"
              android:max="100"
              android:progress="0"
              android:progressTint="#4CAF50" />
            </LinearLayout>

            <!-- Protein Progress -->
            <LinearLayout
              android:layout_width="match_parent"
              android:layout_height="wrap_content"
              android:orientation="vertical">

            <LinearLayout
              android:layout_width="match_parent"
              android:layout_height="wrap_content"
              android:gravity="center_vertical"
              android:orientation="horizontal">

              <ImageView
                android:layout_width="20dp"
                android:layout_height="20dp"
                android:layout_marginEnd="8dp"
                android:contentDescription="protein"
                android:src="@drawable/ic_protein" />

              <TextView
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:text="Protein"
                android:textColor="#111111"
                android:textSize="14sp"
                android:textStyle="bold" />

              <TextView
                android:id="@+id/tv_protein_progress"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="0/203g"
                android:textColor="#6B6B6B"
                android:textSize="12sp" />
            </LinearLayout>

            <ProgressBar
              android:id="@+id/progress_protein"
              style="?android:attr/progressBarStyleHorizontal"
              android:layout_width="match_parent"
              android:layout_height="8dp"
              android:layout_marginTop="6dp"
              android:max="100"
              android:progress="0"
              android:progressTint="#FF9800" />
            </LinearLayout>

          </LinearLayout>

          <!-- Right Column -->
          <LinearLayout
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:layout_marginStart="8dp"
            android:orientation="vertical">

            <!-- Fat Progress -->
            <LinearLayout
              android:layout_width="match_parent"
              android:layout_height="wrap_content"
              android:layout_marginBottom="12dp"
              android:orientation="vertical">

            <LinearLayout
              android:layout_width="match_parent"
              android:layout_height="wrap_content"
              android:gravity="center_vertical"
              android:orientation="horizontal">

              <ImageView
                android:layout_width="20dp"
                android:layout_height="20dp"
                android:layout_marginEnd="8dp"
                android:contentDescription="fat"
                android:src="@drawable/ic_fat" />

              <TextView
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:text="Fat"
                android:textColor="#111111"
                android:textSize="14sp"
                android:textStyle="bold" />

              <TextView
                android:id="@+id/tv_fat_progress"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="0/106g"
                android:textColor="#6B6B6B"
                android:textSize="12sp" />
            </LinearLayout>

            <ProgressBar
              android:id="@+id/progress_fat"
              style="?android:attr/progressBarStyleHorizontal"
              android:layout_width="match_parent"
              android:layout_height="8dp"
              android:layout_marginTop="6dp"
              android:max="100"
              android:progress="0"
              android:progressTint="#F44336" />
            </LinearLayout>

            <!-- Fiber Progress -->
            <LinearLayout
              android:layout_width="match_parent"
              android:layout_height="wrap_content"
              android:orientation="vertical">

            <LinearLayout
              android:layout_width="match_parent"
              android:layout_height="wrap_content"
              android:gravity="center_vertical"
              android:orientation="horizontal">

              <ImageView
                android:layout_width="20dp"
                android:layout_height="20dp"
                android:layout_marginEnd="8dp"
                android:contentDescription="fiber"
                android:src="@drawable/ic_carb" />

              <TextView
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:text="Fiber"
                android:textColor="#111111"
                android:textSize="14sp"
                android:textStyle="bold" />

              <TextView
                android:id="@+id/tv_fiber_progress"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="0/49g"
                android:textColor="#6B6B6B"
                android:textSize="12sp" />
            </LinearLayout>

            <ProgressBar
              android:id="@+id/progress_fiber"
              style="?android:attr/progressBarStyleHorizontal"
              android:layout_width="match_parent"
              android:layout_height="8dp"
              android:layout_marginTop="6dp"
              android:max="100"
              android:progress="0"
              android:progressTint="#9C27B0" />
            </LinearLayout>

          </LinearLayout>

        </LinearLayout>

        <TextView
          android:id="@+id/da_nap"
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:gravity="center"
          android:text="Intake\n0"
          android:textAlignment="center"
          android:textColor="#FF8A00"
          android:textSize="16sp"
          app:layout_constraintBottom_toBottomOf="@id/apple_container"
          app:layout_constraintEnd_toEndOf="@id/apple_container"
          app:layout_constraintStart_toStartOf="@id/apple_container"
          app:layout_constraintTop_toTopOf="@id/apple_container"
          app:layout_constraintVertical_bias="0.6" />

        <!-- Right side small stats -->
        <TextView
          android:id="@+id/stat_button"
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:layout_marginEnd="15dp"
          android:text="Statistics"
          android:textColor="#6B6B6B"
          android:textSize="13sp"
          app:layout_constraintEnd_toEndOf="parent"
          app:layout_constraintTop_toTopOf="parent" />

      </androidx.constraintlayout.widget.ConstraintLayout>

    </androidx.cardview.widget.CardView>

    <!-- Card: Activity List -->
    <androidx.cardview.widget.CardView
      android:id="@+id/card_activity_list"
      android:layout_width="0dp"
      android:layout_height="wrap_content"
      android:layout_marginLeft="8dp"
      android:layout_marginRight="8dp"
      android:layout_marginTop="16dp"
      app:cardCornerRadius="16dp"
      app:cardElevation="3dp"
      app:layout_constraintEnd_toEndOf="parent"
      app:layout_constraintStart_toStartOf="parent"
      app:layout_constraintTop_toBottomOf="@id/quick_add_row">

      <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical">

        <!-- Header with summary stats (always visible) -->
        <include
          android:id="@+id/activity_header"
          layout="@layout/activity_summary_header" />

        <!-- Activities Container Box (hidden by default) -->
        <LinearLayout
          android:id="@+id/activities_container"
          android:layout_width="match_parent"
          android:layout_height="wrap_content"
          android:layout_marginTop="12dp"
          android:layout_marginBottom="12dp"
          android:paddingTop="16dp"
          android:paddingBottom="16dp"
          android:background="#F8F9FA"
          android:orientation="vertical"
          android:visibility="gone">

          <!-- RecyclerView for Activities -->
          <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/activities_recycler_view"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:nestedScrollingEnabled="false" />

          <!-- Empty state message -->
          <TextView
            android:id="@+id/tv_empty_activity"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="You haven't do anything today!"
            android:textSize="16sp"
            android:textColor="#999999"
            android:gravity="center"
            android:padding="20dp"
            android:visibility="gone" />

        </LinearLayout>

      </LinearLayout>

    </androidx.cardview.widget.CardView>

    <!-- Divider after Activity List -->
    <View
      android:id="@+id/divider_below_activities"
      android:layout_width="match_parent"
      android:layout_height="1dp"
      android:background="#E0E0E0"
      app:layout_constraintEnd_toEndOf="parent"
      app:layout_constraintStart_toStartOf="parent"
      app:layout_constraintTop_toBottomOf="@id/card_activity_list" />

  </androidx.constraintlayout.widget.ConstraintLayout>

</androidx.core.widget.NestedScrollView>